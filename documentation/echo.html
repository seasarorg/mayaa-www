<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
    <title>Maya : Documentation : 3-4. タグの属性のみを置き換える</title>
    <link rel="STYLESHEET" href="./maya.css" type="text/css">
</head>
<body>
<div class="header">
<div>Maya : JavaServer Templates</div>
</div>

<div class="navi">
<a href="./index.html">↑index</a>
</div>

<div style="font-size: xx-large; background-color: red; color: white">作成中</div>

<div class="main">


<h1>3-4. タグの属性のみを置き換える</h1>

<p>通常はタグとボディを置き換えるかボディのみを置き換えることで動的ページを生成しますが、場合によってはテンプレートのタグの属性を一部のみ置き換えたいこともあるでしょう。その場合、<code>echo</code> プロセッサを使います。</p>

<h2>簡単な例</h2>

<p>ごく簡単なサンプルで実際に使ってみましょう。<code>ol</code> タグの <code>type</code> 属性を <code>A</code> から <code>i</code> に置き換えます。<code>start</code> 属性はテンプレートのまま出力されます。</p>

<pre>
echo_list.html
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" <strong>type="A"</strong> start="3"&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
echo_list.maya
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;<strong>m:echo</strong> id="list"&gt;
        &lt;<strong>m:attribute</strong> name="type" value="i" /&gt;
    &lt;/<strong>m:echo</strong>&gt;
&lt;/m:maya&gt;</div></pre>

<p>テンプレートの <code>ol</code> タグに <code>m:echo</code> を対応付け、<code>m:echo</code> の子として <code>m:attribute</code> を書きます。<code>m:attribute</code> の <code>name</code> 属性に変更したい属性名、<code>value</code> に変更後の属性値を設定します。<code>m:attribute</code> を複数書けば、複数の属性を置き換えられます。</p>
<p>ブラウザで <code><a href="http://localhost:8080/maya/echo_list.html" target="_blank">http://localhost:8080/maya/echo_list.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" <strong>type="i"</strong> start="3"&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></pre>

<p>他の属性はそのままに、<code>type</code> 属性だけ置き換わりましたね。</p>


<h2>属性を追加する</h2>

<p>先ほどの例は既存の属性値を変更するものでしたが、<code>echo</code> プロセッサで新規に属性を追加することもできます。テンプレートのタグで定義されていない属性名を指定すれば、新規に追加することになります。</p>

<pre>
echo_list.html
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" type="A" start="3"&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
echo_list.maya
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:echo id="list"&gt;
        &lt;m:attribute name="type" value="i" /&gt;
        &lt;m:attribute <strong>name="style"</strong> <strong>value="color: blue;"</strong> /&gt;
    &lt;/m:echo&gt;
&lt;/m:maya&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" type="i" start="3" <strong>style="color: blue;"</strong>&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></pre>


<h2>テンプレートの属性値を利用する</h2>

<p>置き換える <code>m:echo</code> のスコープ内で、テンプレートの属性名を変数名として使用することで、テンプレートの属性値を参照できます。(文字列として取得するため、数値演算する場合には <code>eval</code> などを使う必要があります)</p>

<pre>
echo_list.html
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" type="A" start="3"&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
echo_list.maya
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:echo id="list"&gt;
        &lt;m:attribute name="type" value="i" /&gt;
        &lt;m:attribute name="style" value="color: blue;" /&gt;
        &lt;m:attribute name="<strong>start</strong>" value="&#36;{ eval(<strong>start</strong>) + 2 }" /&gt;
    &lt;/m:echo&gt;
&lt;/m:maya&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ol id="list" type="i" start="<strong>5</strong>" style="color: blue;"&gt;
        &lt;li&gt;item 1&lt;/li&gt;
        &lt;li&gt;item 2&lt;/li&gt;
        &lt;li&gt;item 3&lt;/li&gt;
        &lt;li&gt;item 4&lt;/li&gt;
    &lt;/ol&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></pre>


<!-- TODO 発展的な使い方：ボディで他のプロセッサを使い、doBody する -->


</div>

<div class="navi">
<a href="./index.html">↑index</a>
</div>

<div class="footer">
&copy;2004-2005, The Seasar Foundation and the others, all rights reserved.
</div>

</body>
</html>
