<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
    <title>Mayaa : Documentation : 2-1. 最初の一歩</title>
    <link rel="STYLESHEET" href="./mayaa.css" type="text/css">
</head>
<body>
<div class="header">
<div>Mayaa : JavaServer Templates</div>
</div>

<div class="navi">
<a href="./usebean.html">←どのように使うのか</a>
<a href="./index.html">↑index</a>
<a href="./conditional.html">条件分岐とループ→</a>
</div>

<div class="main">

<h1>2-1. 最初の一歩</h1>

<p>最初に簡単なページを作成し、動作させてみましょう。Tomcat を再起動する必要はありません。「インストールしよう」で動作させた <code>C:\tomcat\webapps\mayaa</code> の下に新しくファイルを追加します。</p>

<h2>Hello Mayaa</h2>

<p>「Hello Mayaa!」とだけ表示するページを作ります。ダミーメッセージを含むテンプレート <code>hello.html</code> と、その設定を行う <code>hello.mayaa</code> を次のように作成します。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;span <strong>id="message"</strong>&gt;dummy message&lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.mayaa</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:mayaa xmlns:m="http://mayaa.seasar.org"&gt;
    &lt;m:write <strong>id="message"</strong> value="<strong>Hello Mayaa!</strong>" /&gt;
&lt;/m:mayaa&gt;</div></pre>

<p>テンプレート <code>hello.html</code> 上の span タグと <code>id</code> が一致するものを mayaa ファイル <code>hello.mayaa</code> 上から探し、<code>value</code> の値である「Hello mayaa!」という文字列に置き換えて出力します。</p>
<p>ブラウザで <code><a href="http://localhost:8080/mayaa/hello.html" target="_blank">http://localhost:8080/mayaa/hello.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果 (改行などは実際の実行結果と異なります)
<div class="file">&lt;html&gt;
&lt;body&gt;
    <strong>Hello Mayaa!</strong>
&lt;/body&gt;
&lt;/html&gt;</div></pre>


<h2>テンプレート上のタグを残す</h2>

<p>mayaa ファイルで使用している <code>m:write</code> は <code>value</code> の値をそのまま出力します。テンプレート上のタグを維持したまま中身だけ書き換えたい場合は、属性として <code>replace="false"</code> を追加します。<code>replace</code> はテンプレート上のタグを残すかどうかの設定で、デフォルトは <code>true</code> です。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;span id="message"&gt;dummy message&lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.mayaa</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:mayaa xmlns:m="http://mayaa.seasar.org"&gt;
    &lt;m:write id="message" value="Hello Mayaa!" <strong>replace="false"</strong> /&gt;
&lt;/m:mayaa&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    <strong>&lt;span id="message"&gt;</strong>Hello Mayaa!<strong>&lt;/span&gt;</strong>
&lt;/body&gt;
&lt;/html&gt;</div></pre>


<h2><a name="script">スクリプトでオブジェクトを出力する</a></h2>

<p>Mayaa では様々な場所でスクリプトを使用できます。スクリプト言語は JavaScript (標準で利用する実装は <a href="http://www.mozilla.org/rhino/" title="Rhino: JavaScript for Java">Rhino</a>) です。スクリプトを使用するときには <code>&#36;{ }</code> で囲んで記述します。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;span id="message"&gt;dummy message&lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.mayaa</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:mayaa xmlns:m="http://mayaa.seasar.org"&gt;
    &lt;m:write id="message" value="<strong>&#36;{ 1 + 2 }</strong>" /&gt;
&lt;/m:mayaa&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    <strong>3</strong>
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<h3>request や session 等に格納されている値を使う</h3>

<p>JSP と同じようにスクリプトから request や session を使えます。たとえば request スコープにある "attributeName" という属性の値を取得するには、<code>&#36;{ request.getAttribute("属性名") }</code> と書きます。</p>
<p>参照するだけであれば、もっと簡単に、直接 <code>&#36;{ 属性名 }</code> と変数名として記述できます。変数をスコープから探す順番は、page スコープ、request スコープ、session スコープ、application スコープの順で、どこにも見つからない場合は例外を投げます。</p>
<p>またクライアントから送信されてきたパラメータを参照するには、<code>&#36;{ param.パラメータ名 }</code> とします。この場合、存在しないパラメータ名を指定すると <code>undefined</code> が返ります。</p>

<p>試しにクライアントから送信されてきたパラメータを参照してみましょう。<code>hello.mayaa</code> を次のように書き換えます。</p>

<pre>
<code>hello.mayaa</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:mayaa xmlns:m="http://mayaa.seasar.org"&gt;
    &lt;m:write id="message" value="Hello <strong>&#36;{ param.name }</strong>" /&gt;
&lt;/m:mayaa&gt;</div></pre>

<p>ブラウザで <code><a href="http://localhost:8080/mayaa/hello.html?name=world" target="_blank">http://localhost:8080/mayaa/hello.html?name=world</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    <strong>Hello world</strong>
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>URL で渡した name を参照できましたね。</p>


</div>

<div class="navi">
<a href="./usebean.html">←どのように使うのか</a>
<a href="./index.html">↑index</a>
<a href="./conditional.html">条件分岐とループ→</a>
</div>

<div class="footer">
&copy;2004-2005, The Seasar Foundation and the others, all rights reserved.
</div>

</body>
</html>
