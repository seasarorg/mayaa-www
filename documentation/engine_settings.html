<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>5-1. エンジン設定方法 : Documentation - JavaServer Templates &quot;Mayaa&quot;</title>
<link href="../css/base.css" rel="stylesheet" type="text/css">
<link href="../css/menu_contents.css" rel="stylesheet" type="text/css">
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" class="background">

<div align="center"><img src="../images/topbar.gif" width="760" height="4"></div>

<div align="center">
<div class="contentslogo"><a href="../index.html" id="menu08"><img src="../images/logo.gif" alt="Mayaa JavaServer Template" width="430" height="48"></a><img src="../images/topstripe.gif" width="330" height="48"></div>
<div class="menudocs">
<a href="../about/index.html" id="menu01"><img src="images/menu_about.gif" width="125" height="55"></a><img src="images/menu_div.gif" width="1" height="55"><a href="../news/index.html" id="menu02"><img src="images/menu_news.gif" alt="News" width="126" height="55" border="0"></a><img src="images/menu_div.gif" width="1" height="55"><a href="index.html"><img src="images/menu_doc_o.gif" width="126" height="55"></a><img src="images/menu_div.gif" width="1" height="55"><a href="../downloads/index.html" id="menu04"><img src="images/menu_down.gif" alt="downloads" width="126" height="55"></a><img src="images/menu_div.gif" width="1" height="55"><a href="../subprojects/index.html" id="menu05"><img src="images/menu_subpro.gif" alt="SubProjects" width="126" height="55"></a><img src="images/menu_div.gif" width="1" height="55"><a href="../support/index.html" id="menu06"><img src="images/menu_support.gif" alt="Support" width="126" height="55"></a>
</div>
</div>


<div class="maincontents">
<div id="contentsleft">
<img src="../images/arrow02.gif" align="absmiddle"><a href="../index.html" class="text11px">Top</a>
<div class="sidemenu"><a href="index.html">Documentation Top</a></div>

    <div class="sidemenu"><a href="changelog.html">更新履歴</a></div>
    <div class="sidemenu"><a href="slide.html">スライドなど</a></div>
    <div class="sidemenu"><a href="about.html">1. Mayaa導入</a></div>
    <div class="sidemenu"><a href="hello.html">2. チュートリアル</a></div>
    <div class="sidemenu"><a href="default.html">3. How To</a></div>
    <div class="sidemenu"><a href="processor_reference.html">4. リファレンス</a></div>
    <div class="sidemenu"><a href="engine_settings.html">5. エンジン設定</a></div>
      <div class="sidemenutext"><span>5-1. エンジン設定方法</span></div>
      <div class="sidemenutext"><a href="jsp_template_attribute.html">5-2. 属性自動セット</a></div>
      <div class="sidemenutext"><a href="auto_build.html">5-3. 自動ビルド</a></div>
      <div class="sidemenutext"><a href="page_serialize.html">5-4. ビルド結果キャッシュ</a></div>
      <div class="sidemenutext"><a href="error_handler.html">5-5. エラー処理の設定</a></div>
      <div class="sidemenutext"><a href="equals_id_resolver.html">5-6. id属性を無視する</a></div>
      <div class="sidemenutext"><a href="template_path.html">5-7. テンプレートの場所</a></div>
      <div class="sidemenutext"><a href="default_layout.html">5-8. デフォルトレイアウト</a></div>
      <div class="sidemenutext"><a href="path_adjust_settings.html">5-9. パス自動調整の設定</a></div>
      <br>
    <div class="sidemenu"><a href="mayaa_customtag_diff.html">A. 付録</a></div>

    <br>
    <div class="sidemenu"><a href="link.html">外部へのリンク</a></div>

</div>


<div id="contentsright">
<h1><a id="top" name="top"></a>Documentation</h1>

<h2>5-1. エンジン設定方法</h2>

<h3>ServiceProviderの設定</h3>

<p>Mayaa エンジンの設定には、次に示す XML ファイルを使います。このファイルは <code>META-INF</code> の下に <code>org.seasar.mayaa.provider.ServiceProvider</code> という名前で作成します。</p>

<div class="figure">図 5-1-1: ファイルを置く場所<br>
<pre>WEB-INF/
 +-- classes/
 |    |
 |    +-- META-INF/
 |    |    |
 |    |    +-- <strong>org.seasar.mayaa.provider.ServiceProvider</strong>
 |    |
 |    +-- (クラスファイルなど)
 |
 +-- lib/
 |
 (省略)
</pre>
</div>

<h4>■何もしない設定ファイル</h4>

<p>これは何もしない設定ファイルです。この中に各種の設定を書くことで、Mayaa の動作を設定できます。</p>

<pre>
<code>org.seasar.mayaa.provider.ServiceProvider</code>
<span class="file">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE provider
    PUBLIC "-//The Seasar Foundation//DTD Mayaa Provider 1.0//EN"
    "http://mayaa.seasar.org/dtd/mayaa-provider_1_0.dtd"&gt;
&lt;provider&gt;

&lt;/provider&gt;</span></pre>


<h4>■Engine のパラメータ</h4>

<p>Mayaa 標準の Engine に対するパラメータをいくつか説明します。デフォルト設定は下記の通りです。</p>

<pre>
<code>org.seasar.mayaa.provider.ServiceProvider</code>
<span class="file">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE provider
    PUBLIC "-//The Seasar Foundation//DTD Mayaa Provider 1.0//EN"
    "http://mayaa.seasar.org/dtd/mayaa-provider_1_0.dtd"&gt;
&lt;provider&gt;
    &lt;engine&gt;
        &lt;parameter name="<code>defaultSpecification</code>" value="<code>/default.mayaa</code>"/&gt;
        &lt;parameter name="<code>checkTimestamp</code>" value="<code>true</code>"/&gt;
        &lt;parameter name="<code>suffixSeparator</code>" value="<code>$</code>"/&gt;
        &lt;parameter name="<code>welcomeFileName</code>" value="<code>index.html</code>"/&gt;
        &lt;parameter name="<code>requestCharacterEncoding</code>" value="<code>UTF-8</code>"/&gt;
        &lt;parameter name="<code>surviveLimit</code>" value="<code>5</code>"/&gt;
        &lt;parameter name="<code>forwardLimit</code>" value="<code>10</code>"/&gt;
        &lt;parameter name="<code>convertCharset</code>" value="<code>false</code>"/&gt;
    &lt;/engine&gt;
&lt;/provider&gt;</span></pre>


<p>上記の 6 項目について説明します。</p>

<dl class="list">
    <dt><code>defaultSpecification</code></dt>
    <dd><a href="default.html">すべてのページ共通に利用する Mayaa ファイル</a>のパスを指定します。デフォルトは "<code>/default.mayaa</code>" です。</dd>
    <dt><code>checkTimestamp</code></dt>
    <dd>HTML ファイル、Mayaa ファイルの更新を検知して再ビルドする機能を有効にするかどうかを設定します。"<code>true</code>" なら有効、"<code>false</code>" なら無効です。デフォルトは "<code>true</code>" です。</dd>
    <dt><code>suffixSeparator</code></dt>
    <dd><a href="template_suffix.html">テンプレート切り替え機能</a>でページ名と suffix とを区別するための文字列を指定します。デフォルトは "<code>$</code>" です。</dd>
    <dt><code>requestedSuffixEnabled</code></dt>
    <dd><a href="template_suffix.html">テンプレート切り替え機能</a>で suffix を明示したアクセスを許すかどうかを設定します。アクセス時に明示した suffix は最優先になります。デフォルトは "<code>false</code>" です。</dd>
    <dt><code>welcomeFileName</code></dt>
    <dd>URL の最後が "<code>/</code>" でアクセスされた場合にリダイレクトする先のファイル名を指定します。デフォルトは "<code>index.html</code>" です。</dd>
    <dt><code>requestCharacterEncoding</code></dt>
    <dd>Mayaa でリクエストパラメータを参照する際の文字コードを指定します。デフォルトは "<code>UTF-8</code>" です。<code>MayaaServlet</code> の前に <code>HttpServletRequest#setCharacterEncoding(String encoding)</code> でセットされている場合はこの設定を使用しません。</dd>
    <dt><code>surviveLimit</code></dt>
    <dd>ページのビルド結果をガーベジコレクションの対象にするまでの回数を指定します。デフォルトは "<code>5</code>" です。ここで指定した回数だけ解放要求が来たときに初めて、ページのビルド結果オブジェクトがガーベジコレクションの対象になります。また値として "<code>0</code>" を設定した場合、ビルド結果はガーベジコレクションの対象になりません。</dd>
    <dt><code>forwardLimit</code></dt>
    <dd>一回のレンダリング中に Mayaa の同一パスへ forward できる上限回数を指定します。デフォルトは "<code>10</code>" です。このパラメータは記述ミスで無限ループしてしまうのを避けるためにあります。</dd>
    <dt><code>convertCharset</code> (<strong>※</strong>1.1.12 で追加されたパラメータ)</dt>
    <dd>テンプレートの meta タグで charset を "<code>Windows-31J</code>" としたとき、出力する HTML および HTTP レスポンスヘッダの Content-Type の charset として "<code>Shift_JIS</code>" を出力するかどうか設定します。"<code>true</code>" なら有効、"<code>false</code>" なら無効です。デフォルトは "<code>false</code>" です。</dd>
</dl>


<h4>■TemplateBuilder のパラメータ</h4>

<p>Mayaa 標準の <code>TemplateBuilder</code> に対するパラメータをいくつか説明します。デフォルト設定は下記の通りです。</p>
<p>この <code>templateBuilder</code> は 5-6「<a href="equals_id_resolver.html">id属性を無視する</a>」でパラメータ以外にも設定を紹介しています。

<pre>
<code>org.seasar.mayaa.provider.ServiceProvider</code>
<span class="file">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE provider
    PUBLIC "-//The Seasar Foundation//DTD Mayaa Provider 1.0//EN"
    "http://mayaa.seasar.org/dtd/mayaa-provider_1_0.dtd"&gt;
&lt;provider&gt;
    &lt;templateBuilder&gt;
        &lt;parameter name="<code>outputTemplateWhitespace</code>" value="<code>true</code>"/&gt;
        &lt;parameter name="<code>outputMayaaWhitespace</code>" value="<code>false</code>"/&gt;
        &lt;parameter name="<code>optimize</code>" value="<code>true</code>"/&gt;
        &lt;parameter name="<code>defaultCharset</code>" value="<code>UTF-8</code>"/&gt;
                &lt;!-- <strong>※</strong>1.1.22 で追加されたパラメータ --&gt;
    &lt;/templateBuilder&gt;
&lt;/provider&gt;</span></pre>

</p><p>上記の 4 項目について説明します。</p>

<dl class="list">
    <dt><code>outputTemplateWhitespace</code></dt>
    <dd>HTML ファイル上の空白文字(スペース、タブ文字)を出力するかどうか設定します。"<code>true</code>" なら出力し、"<code>false</code>" なら出力しません。デフォルトは "<code>true</code>" です。</dd>
    <dt><code>outputMayaaWhitespace</code></dt>
    <dd>Mayaa ファイル上の空白文字(スペース、タブ文字)を出力するかどうか設定します。"<code>true</code>" なら出力し、"<code>false</code>" なら出力しません。デフォルトは "<code>false</code>" です。</dd>
    <dt><code>optimize</code></dt>
    <dd>テンプレートビルド後の最適化をするかどうか設定します。最適化をすると描画パフォーマンスが向上します。"<code>true</code>" なら有効、"<code>false</code>" なら無効です。デフォルトは "<code>true</code>" です。</dd>
    <dt><code>defaultCharset</code></dt>
    <dd>HTML ファイルを読み込むときのデフォルト文字コードを指定します。デフォルトは "<code>UTF-8</code>" です。ここで指定した文字コードで HTML ファイルの先頭部分を読み込み、meta タグによる charset 指定を見つけたときは、meta タグで指定された文字コードで読み込み直します。</dd>
</dl>


<div class="navi"><a href="#top">↑このページのトップへ</a></div>
<div class="navi-prev"><a href="implicit_object.html">＜ 4-2. 定義済みオブジェクト</a></div>
<div class="navi-next"><a href="jsp_template_attribute.html">5-2. 属性自動セット ＞</a></div>
<div class="navi-end">&nbsp;</div>

</div>

<div class="copyrights" align="center">
<img src="../images/copyrights.gif" alt="Copyright (c) 2004-2008 the Seasar Foundation and others. all rights reserved." width="760" height="20">
</div>
</div>
</body>
</html>