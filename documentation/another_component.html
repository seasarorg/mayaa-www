<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
    <title>Maya : Documentation : 3-6. もうひとつのコンポーネント記述方法</title>
    <link rel="STYLESHEET" href="./maya.css" type="text/css">
</head>
<body>
<div class="header">
<div>Maya : JavaServer Templates</div>
</div>

<div class="navi">
<a href="./with.html">←ひとつのタグに複数のプロセッサを対応付ける</a>
<a href="./index.html">↑index</a>
<a href="./xpath.html">id 指定の代わりに XPath を使う→</a>
</div>

<div class="main">

<h1>3-6. もうひとつのコンポーネント記述方法</h1>


<h2>コンポーネントの簡略記述</h2>

<p>コンポーネントを利用する際の記述方法には、<code>insert</code> プロセッサを使う以外にも簡略記述があります。簡略記述では名前空間としてコンポーネントのあるフォルダパスを指定し、タグとしてコンポーネントファイル名を指定します。フォルダパスはコンテキストルートからの相対パスで書きます。コンポーネントを利用するテンプレートからの相対パスではありませんので注意してください。</p>

<pre>
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org" <strong>xmlns:x="/components"</strong>&gt;

    &lt;<strong>x:component1.html</strong> m:id="message" <strong>x:greeting="hello"</strong> /&gt;

&lt;/m:maya&gt;
</pre>

<p>これは次の表記と同じ意味です。(正確には「<code>greeting</code>」の名前空間が違います)</p>

<pre>
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;

    &lt;m:insert m:id="message"
        <strong>m:path="/components/component1.html"</strong> <strong>m:greeting="hello"</strong> /&gt;

&lt;/m:maya&gt;
</pre>

<p>ここでは名前空間プレフィクスとして「<code>x</code>」を使っていますが、「<code>x</code>」に限らず任意の名前空間を使えます。あらかじめ独自の名前空間を定義していますので「<code>id</code>」や「<code>name</code>」のような変数を制限されることなく使えます。逆に <code>m:id</code> や <code>m:replace</code> などの名前空間プレフィクス「<code>m</code>」を省略できません。</p>


<h2>簡単な例</h2>

<p>ごく簡単なサンプルで実際に使ってみましょう。まずは通常の表記で作ります。コンポーネントにパラメータ「<code>target</code>」を渡しています。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;dummy&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:insert id="comp" replace="false"
            <strong>path="/components/component.html"</strong> target="world" /&gt;
&lt;/m:maya&gt;</div>
<code>component.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;dummy for preview&lt;/h1&gt;
    &lt;span id="centered"&gt;
        &lt;div style="text-align: center"&gt;component value&lt;/div&gt;
    &lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>component.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:doRender id="centered" replace="false" /&gt;

    &lt;m:write id="message" value="&#36;{ binding.target }" /&gt;
&lt;/m:maya&gt;</div></pre>

<p>ブラウザで <code><a href="http://localhost:8080/maya/hello.html" target="_blank">http://localhost:8080/maya/hello.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;<strong>&lt;span id="centered"&gt;</strong>
        <strong>&lt;div style="text-align: center"&gt;world&lt;/div&gt;</strong>
    <strong>&lt;/span&gt;</strong>&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>正しくコンポーネントの内容が表示されています。</p>

<p>では次に <code>hello.maya</code> の内容を次のように書き換えて実行してみましょう。置き換わっていることを確認するために <code>target</code> の内容を少し変えます。</p>

<pre>
<code>hello.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org" <strong>xmlns:x="/components"</strong>&gt;
    &lt;<strong>x:component.html</strong> <strong>m:</strong>id="comp" <strong>m:</strong>replace="false" target="<strong>new world</strong>" /&gt;
&lt;/m:maya&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;<strong>&lt;span id="centered"&gt;</strong>
        <strong>&lt;div style="text-align: center"&gt;new world&lt;/div&gt;</strong>
    <strong>&lt;/span&gt;</strong>&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>同様に動作していることが分かります。</p>


<h2>注意点</h2>

<p>簡略表記はファイル名をタグ名として使うため、タグ名として禁止されている名前のファイルを使うことはできません。たとえば「数字で始まる名前」はタグとして使えませんので使用できません。</p>


</div>

<div class="navi">
<a href="./with.html">←ひとつのタグに複数のプロセッサを対応付ける</a>
<a href="./index.html">↑index</a>
<a href="./xpath.html">id 指定の代わりに XPath を使う→</a>
</div>

<div class="footer">
&copy;2004-2005, The Seasar Foundation and the others, all rights reserved.
</div>

</body>
</html>
