<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
    <title>Maya : Documentation : 3-7. id 指定の代わりに XPath を使う</title>
    <link rel="STYLESHEET" href="./maya.css" type="text/css">
</head>
<body>
<div class="header">
<div>Maya : JavaServer Templates</div>
</div>

<div class="navi">
<a href="./another_component.html">←もうひとつのコンポーネント記述方法</a>
<a href="./index.html">↑index</a>
<a href="./remove.html">指定したタグを出力しないようにする→</a>
</div>

<div class="main">


<h1>3-7. id 指定の代わりに XPath を使う</h1>

<p>テンプレートのタグとプロセッサを関連付けるには id を使いますが、その代替手段として XPath を使う方法があります。使うには maya ファイルで id="テンプレートの id" と書く代わりに <code><strong>xpath="XPath ロケーションパス"</strong></code> と書きます。XPath に関する説明や参考資料はこのページの最後にあります。</p>


<h2>簡単な例</h2>

<p>テンプレートで <code>id</code> 属性を持たないタグのボディを置き換えてみましょう。XPath のロケーションパスで <code>h1</code> タグを指定します。</p>

<pre>
xpath.html
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Dummy&lt;/h1&gt;
    &lt;p&gt;content&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
xpath.maya
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:write <strong>xpath="/html/body/h1"</strong> value="<strong>Title</strong>" replace="false" /&gt;
&lt;/m:maya&gt;</div></pre>

<p>ルートはそのまま HTML のルートですので、 "<code>/html/body/h1</code>" というロケーションパスは <code>h1</code> タグを指します。</p>
<p>ブラウザで <code><a href="http://localhost:8080/maya/xpath.html" target="_blank">http://localhost:8080/maya/xpath.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;<strong>Title</strong>&lt;/h1&gt;
    &lt;p&gt;content&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>テンプレートに <code>id</code> がなくても置き換わっているのがわかります。</p>


<h2>複数のタグを一度に指定する</h2>

<p>XPath では、複数のタグにマッチするロケーションパスを指定できます。複数のタグにマッチした場合、マッチしたすべてのタグがプロセッサに対応付けられます。</p>
<p>次の例では XPath のロケーションパスに "<code>//a</code>" を指定しています。このパスはすべての <code>a</code> タグにマッチしますので、すべての <code>a</code> タグに <code>target="_blank"</code> を追加します。</p>

<pre>
xpath_multi.html
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;a href="path1.html"&gt;link1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="path2.html"&gt;link2&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="path3.html"&gt;link3&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
xpath_multi.maya
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:echo xpath="<strong>//a</strong>"&gt;
        <strong>&lt;m:attribute name="target" value="_blank" /&gt;</strong>
    &lt;/m:echo&gt;
&lt;/m:maya&gt;</div></pre>

<p>ブラウザで <code><a href="http://localhost:8080/maya/xpath_multi.html" target="_blank">http://localhost:8080/maya/xpath_multi.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;a href="path1.html" <strong>target="_blank"</strong>&gt;link1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="path2.html" <strong>target="_blank"</strong>&gt;link2&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="path3.html" <strong>target="_blank"</strong>&gt;link3&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>指定したロケーションパスにマッチするもの、つまりすべての <code>a</code> タグに <code>target="_blank"</code> が追加されているのが分かります。</p>


<h2>XPath</h2>

<p>XPath は XML 文書からノードを選択するための簡潔な言語で、「ロケーションパス」という表記を使ってノードを指定します。"/" 区切りでノードを選択する表記はロケーションパスの簡略表記です。Java2 SDK 5.0 から XPath を評価するための API (javax.xml.xpath) が提供されます。</p>
<p>XPath については参考文献をご覧ください。</p>


<h3><a name="reference">参考文献</a></h3>

<dl>
<dt>XML Path Language (XPath)</dt>
<dd><cite><a href="http://www.w3.org/TR/xpath">http://www.w3.org/TR/xpath</a></cite></dd>
<dd>日本語訳: <cite><a href="http://www.infoteria.com/jp/contents/xml-data/REC-xpath-19991116-jpn.htm">http://www.infoteria.com/jp/contents/xml-data/REC-xpath-19991116-jpn.htm</a></cite></dd>


</div>

<div class="navi">
<a href="./another_component.html">←もうひとつのコンポーネント記述方法</a>
<a href="./index.html">↑index</a>
<a href="./remove.html">指定したタグを出力しないようにする→</a>
</div>

<div class="footer">
&copy;2004-2005, The Seasar Foundation and the others, all rights reserved.
</div>

</body>
</html>
