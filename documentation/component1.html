<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
    <title>Maya : Documentation : 2-6. HTML 部品を使う (静的)</title>
    <link rel="STYLESHEET" href="./maya.css" type="text/css">
</head>
<body>
<div class="header">
<div>Maya : JavaServer Templates</div>
</div>

<div class="navi">
<a href="./notation.html">←設定の記述方法</a>
<a href="./index.html">↑index</a>
<a href="./component2.html">HTML 部品を使う (動的)→</a>
</div>

<div class="main">


<h1>2-6. HTML 部品を使う (静的)</h1>

<p>Maya には HTML テンプレートと maya ファイルのセットを部品として扱う機能があります。このテンプレート部品のことを「コンポーネント」と呼びます。コンポーネントを作ることで機能の共有・再利用を実現できます。</p>
<p>コンポーネントの作り方は簡単で、基本的には通常の HTML テンプレートを作るのと変わりません。作った HTML テンプレートのうちコンポーネントにしたい部分に id をつけ、<code>doRender</code> プロセッサと結びつけることでコンポーネントとして扱えるようになります。元の HTML テンプレートはそのままですから、通常の HTML テンプレートとして動作をテストすることもできます。</p>

<div class="figure">図 2-6-1: コンポーネントはテンプレートの一部として作成<br><img src="./images/component1.png" title="図 2-6-1: コンポーネントはテンプレートの一部として作成" width="472" height="144"></div>


<h2>簡単な例</h2>

<p>まずは簡単な例として、静的な表示のコンポーネントを作ってみましょう。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div <strong>id="comp"</strong>&gt;dummy&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;<strong>m:insert</strong> <strong>id="comp"</strong> <strong>path="/component.html"</strong> rendered="true" /&gt;
&lt;/m:maya&gt;</div>
<code>component.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;dummy for preview&lt;/h1&gt;
    &lt;span <strong>id="centered"</strong>&gt;
        <strong>&lt;div style="text-align: center"&gt;component value&lt;/div&gt;</strong>
    &lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>component.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;<strong>m:doRender</strong> <strong>id="centered"</strong> rendered="true" /&gt;
&lt;/m:maya&gt;</div></pre>

<p>関係するファイルは４つです。ユーザからリクエストされる <code>hello.html</code> およびその maya ファイル、それと <code>hello.html</code> から呼び出される <code>component.html</code> およびその maya ファイルです。</p>
<p>ブラウザで <code><a href="http://localhost:8080/maya/hello.html" target="_blank">http://localhost:8080/maya/hello.html</a></code> にアクセスしてみましょう。</p>

<pre>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;<strong>&lt;span id="centered"&gt;</strong>
        <strong>&lt;div style="text-align: center"&gt;component value&lt;/div&gt;</strong>
    <strong>&lt;/span&gt;</strong>&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<p>実行結果は、ベースとなる <code>hello.html</code> の <code>&lt;div id="comp"&gt;</code> のボディが、コンポーネントである <code>component.html</code> の <code>&lt;span id="centered"&gt;</code> によって置き換えられたものになっています。</p>

<div class="figure">図 2-6-2: コンポーネント描画イメージ<br><img src="./images/component2.png" title="図 2-6-2: コンポーネント描画イメージ" width="543" height="248"></div>

<p>このとき <code>doRender</code> プロセッサおよび <code>insert</code> プロセッサに割り当てられているタグを出力するかどうかは、それぞれの <code>rendered</code> の値に従います。この例では <code>hello.html</code> と <code>component.html</code> の両方とも <code>rendered="true"</code> ですので、<code>hello.html</code> のタグの内側に <code>component.html</code> のタグが出力されています。</p>


<h2>ひとつのテンプレートで複数のコンポーネントを定義する</h2>

<p>コンポーネントはひとつのテンプレートで複数定義できます。定義したコンポーネントを区別するには、それぞれのコンポーネントに名前を付け、呼び出すときにその名前を指定します。</p>
<p>名前を付けない場合、空文字列 ("") が名前として使われます。また、同一テンプレート上の複数のコンポーネントに同じ名前を付けることはできません。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp1"&gt;dummy&lt;/div&gt;
    &lt;div id="comp2"&gt;dummy&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:insert id="comp1" path="/component.html" <strong>name="center1"</strong> rendered="true" /&gt;
    &lt;m:insert id="comp2" path="/component.html" <strong>name="center2"</strong> rendered="true" /&gt;
&lt;/m:maya&gt;</div>
<code>component.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;dummy for preview&lt;/h1&gt;
    &lt;span <strong>id="centered1"</strong>&gt;
        &lt;div style="text-align: center"&gt;component value 1&lt;/div&gt;
    &lt;/span&gt;
    &lt;span <strong>id="centered2"</strong>&gt;
        &lt;div style="text-align: center"&gt;component value 2&lt;/div&gt;
    &lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>component.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:doRender id="centered1" <strong>name="center1"</strong> rendered="true" /&gt;
    &lt;m:doRender id="centered2" <strong>name="center2"</strong> rendered="true" /&gt;
&lt;/m:maya&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp1"&gt;&lt;span id="centered1"&gt;
        &lt;div style="text-align: center"&gt;component value 1&lt;/div&gt;
    &lt;/span&gt;&lt;/div&gt;
    &lt;div id="comp2"&gt;&lt;span id="centered2"&gt;
        &lt;div style="text-align: center"&gt;component value 2&lt;/div&gt;
    &lt;/span&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>


<h2>コンポーネントでコンポーネントを使う</h2>

<p>コンポーネントは通常のテンプレート同様、他のコンポーネントを利用できます。利用方法も同様です。</p>
<p>次の例は <code>hello.html</code> が <code>component1.html</code> のコンポーネントを利用し、<code>component1.html</code> のコンポーネントが <code>component2.html</code> のコンポーネントを利用しています。</p>

<pre>
<code>hello.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;dummy&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>hello.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:insert id="comp" path="/component1.html" rendered="true" /&gt;
&lt;/m:maya&gt;</div>
<code>component1.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;dummy for preview&lt;/h1&gt;
    &lt;span id="centered"&gt;
        &lt;div style="text-align: center"&gt;component value 1&lt;/div&gt;
        &lt;div id="comp2"&gt;dummy&lt;/div&gt;
    &lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
<code>component1.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    &lt;m:doRender id="centered" rendered="true" /&gt;
    &lt;m:insert id="comp2" path="/component2.html" rendered="true" /&gt;
&lt;/m:maya&gt;</div>
<code>component2.html</code>
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;dummy for preview&lt;/h1&gt;
    <strong>&lt;span id="righted"&gt;</strong>
        <strong>&lt;div style="text-align: right"&gt;component value 2&lt;/div&gt;</strong>
    <strong>&lt;/span&gt;</strong>
&lt;/body&gt;
&lt;/html&gt;</div>
<code>component2.maya</code>
<div class="file">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;m:maya xmlns:m="http://maya.seasar.org"&gt;
    <strong>&lt;m:doRender id="righted" rendered="true" /&gt;</strong>
&lt;/m:maya&gt;</div>
実行結果
<div class="file">&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Hello&lt;/h1&gt;
    &lt;div id="comp"&gt;&lt;span id="centered"&gt;
        &lt;span style="text-align: center"&gt;component value 1&lt;/span&gt;
        <strong>&lt;div id="comp2"&gt;&lt;span id="righted"&gt;</strong>
            <strong>&lt;div style="text-align: right"&gt;component value 2&lt;/div&gt;</strong>
        <strong>&lt;/span&gt;&lt;/div&gt;</strong>
    &lt;/span&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div></pre>

<div class="figure">図 2-6-3: 2 段のコンポーネント描画イメージ<br><img src="./images/component3.png" title="図 2-6-3: 2 段のコンポーネント描画イメージ" width="543" height="355"></div>


</div>

<div class="navi">
<a href="./notation.html">←設定の記述方法</a>
<a href="./index.html">↑index</a>
<a href="./component2.html">HTML 部品を使う (動的)→</a>
</div>

<div class="footer">
&copy;2004-2005, The Seasar Foundation and the others, all rights reserved.
</div>

</body>
</html>
